#:import Factory kivy.factory.Factory

<Button>:
    font_size: 12
    color: "white"
<Spinner>:
    font_size: 10
<SpinnerOption>
    font_size: 10

<TripDeletePopup@Popup>:
    size_hint: .7, .2
    title: "Delete Trip"
    Button:
        text: "Confirm!"
        pos_hint: {"top": .5}
        size_hint: 1, .3
        on_release: app.trip_page.remove_trip()
        

<LoginPage>:
    inp_email: inp_email
    inp_password: inp_password
    login_btn: login_btn
    register_btn: register_btn
    clear_btn: clear_btn
    action_msg: action_msg
    FloatLayout:
        TextInput:
            id: inp_email
            hint_text: "Email"
            size_hint: .9, .1
            pos_hint: {"right": .95, "top": .98}
        TextInput:
            id: inp_password
            hint_text: "Password"
            password: "True"
            size_hint: .9, .1
            pos_hint: {"right": .95, "top": .87}
        Label:
            id: action_msg
            text_size: root.width, None
            valign: "middle"
            halign: "center"
            color: "green"
            size_hint: .8, 0.25
            pos_hint: {"x": .1 ,"top": .76}
        Button:
            id: login_btn
            text: "Login"
            size_hint: 1, .15
            pos_hint: {"top": .5}
            on_press: root.login()
        Button:
            id: register_btn
            text: "Register"
            size_hint: 1, .15
            pos_hint: {"top": .34}
            on_press: root.register()
        Button:
            id: clear_btn
            text: "Clear"
            size_hint: 1, .15
            pos_hint: {"top": .18}
            on_press: root.clear()

<MainPage>:
    header: header
    FloatLayout:
        Label:
            id: header
            text: ""
            halign: "center"
            valign: "top"
            font_size: 18
            size_hint: (1, .2)
            pos_hint: {"top":1}
        Button:
            id: new_trip
            text: "New Trip"
            size_hint: (1, .15)
            pos_hint: {"top": .7}
            on_press: root.new_trip()
        Button:
            id: view_trips
            text: "View Trips"
            size_hint: (1, .15)
            pos_hint: {"top": .53}
            on_press: root.view_trips()
        Button:
            id: manage_account_btn
            text: "Manage Account"
            size_hint: (1, .15)
            pos_hint: {"top": .36}
            on_press: root.manage_account()
        Button:
            id: logout_btn
            text: "Logout"
            size_hint: (1, .15)
            pos_hint: {"top": .19}
            on_press: root.logout()


<ManageAccountPage>:
    updated_email: updated_email
    updated_password: updated_password
    clear_btn: clear_btn
    update_btn: update_btn
    delete_btn: delete_btn
    action_msg: action_msg
    home_btn: home_btn

    TextInput:
        id: updated_email
        hint_text: "New Email"
        size_hint: .9, .1
        pos_hint: {"right": .95, "top": .98}
    TextInput:
        id: updated_password
        hint_text: "New Password"
        password: "True"
        size_hint: .9, .1
        pos_hint: {"right": .95, "top": .87}
    Label:
        id: action_msg
        text_size: root.width, None
        valign: "middle"
        halign: "center"
        color: "green"
        size_hint: .8, .15
        pos_hint: {"x": .1, "top": .76}
    Button:
        id: update_btn
        text: "Update Account"
        size_hint: 1, .15
        pos_hint: {"top": .6}
        on_press: root.update_account()
    Button:
        id: delete_btn
        text: "Delete Account"
        size_hint: 1, .15
        pos_hint: {"top": .44}
        on_press: root.delete_account()
    Button:
        id: clear_btn
        text: "Clear"
        size_hint: 1, .15
        pos_hint: {"top": .28}
        on_press: root.clear()
    Button:
        id: home_btn
        text: "Home"
        size_hint: 1, .1
        pos_hint: {"top": .12}
        on_press: root.go_home()

<NewTripPage>:
    out_day: out_day
    out_month: out_month
    out_year: out_year
    in_day: in_day
    in_month: in_month
    in_year: in_year
    origin_city: origin_city
    dest_city: dest_city
    FloatLayout:
        Label:
            text: "Search Flights"
            font_size: 18
            size_hint: 1, .1
            pos_hint: {"top": 1}
        Label:
            text: "Outbound Date"
            size_hint: .1, .1
            pos_hint: {"x": .45, "top": .85}
        Spinner:
            id: out_day
            size_hint: .15, .06
            pos_hint: {"x": .275, "top": .75}
            text: "Day"
            values: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31']
            sync_height: "true"
        Spinner:
            id: out_month
            size_hint: .15, .06
            pos_hint: {"x": .425, "top": .75}
            text: "Month"
            values: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12']
            sync_height: "true"

        Spinner:
            id: out_year
            size_hint: .15, .06
            pos_hint: {"x": .575, "top": .75}
            text: "Year"
            values: ['2020', '2021']
            sync_height: "true"
        Label:
            text: "Inbound Date"
            size_hint: .1, .1
            pos_hint: {"x": .45, "top": .7}
        Spinner:
            id: in_day
            size_hint: .15, .06
            pos_hint: {"x": .275, "top": .6}
            text: "Day"
            values: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31']
            sync_height: "true"
        Spinner:
            id: in_month
            size_hint: .15, .06
            pos_hint: {"x": .425, "top": .6}
            text: "Month"
            values: ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12']
            sync_height: "true"
        Spinner:
            id: in_year
            size_hint: .15, .06
            pos_hint: {"x": .575, "top": .6}
            text: "Year"
            values: ['2020', '2021']
            sync_height: "true"
        Label:
            text: "City"
            size_hint: .1, .1
            pos_hint: {"x": .45, "top": .55}
        Spinner:
            id: origin_city
            size_hint: .225, .06
            pos_hint: {"x": .275, "top": .45}
            text: "Origin"
            values: ['Edinburgh', 'Glasgow', 'Krakow', 'Warsaw']
            sync_height: "true"
        Spinner:
            id: dest_city
            size_hint: .225, .06
            pos_hint: {"x": .5, "top": .45}
            text: "Destination"
            values: ['Krakow', 'Warsaw', 'Edinburgh', 'Glasgow']
            sync_height: "true"
        Button:
            id: search
            text: "Search"
            size_hint: .2, .1
            pos_hint: {"x": .4, "top": .3}
            on_press: root.search_trips()
        Button:
            text: "Home"
            size_hint: .2, .1
            pos_hint: {"x": .4, "top": .15}
            on_press: root.go_home()

<TripsSearchResults>:
    scroll_content: scroll_content
    header: header
    FloatLayout:
        Label:
            id: header
            size_hint: 1, .1
            pos_hint: {"top": 1}
            text: ""
            background_color: 1, 1, 1, 1
        ScrollView:
            id: scroll_content
            pos_hint: {"top": .9}
            size_hint: 1, .8
            do_scroll_x: False
            do_scroll_y: True
        Button:
            size_hint: .5, .1
            text: 'Home' if app.root.current == "Out" else 'Back'
            on_press:
                if app.root.current == "Out": app.root.current = 'Manage'
                else: app.root.current = 'Out'
        Button:
            size_hint: .5, .1
            pos_hint: {"x": .5}
            text: "Continue"
            on_press: root.cont()


<TripPage>:
    header: header
    remove: remove
    prices_out: prices_out
    prices_in: prices_in
    graph: graph
    prev: prev
    next: next
    home: home
    graph_scroll: graph_scroll

    FloatLayout:
        FloatLayout:
            size_hint: 1, .3
            pos_hint: {"top": 1}
            Label:
                id: header
                text_size: root.width, None
                valign: "middle"
                halign: "center"
                color: "yellow"
                text: ""
                font_size: 11
                size_hint: 1, .5
                pos_hint: {"top": 1}
            Label:
                id: prices_out
                text: ""
                color: "blue"
                font_size: 12
                size_hint: .5, .5
                pos_hint: {"top": .5}
            Label:
                id: prices_in
                text: ""
                color: "red"
                font_size: 12
                size_hint: .5, .5
                pos_hint: {"x": .5, "top": .5 }
        ScrollView:
            id: graph_scroll
            size_hint: 1, .6
            pos_hint: {"top": .7}
            on_touch_move: root.scroll_move(args)
            Graph:
                id: graph
                ylabel: 'Price'
                size_hint_x: None
                size: 800, root.height
                size_hint_y: 1
                font_size: 10
                x_ticks_major: 1
                y_ticks_minor: 1
                y_ticks_major: 10
                x_ticks_angle: 0
                y_grid_label: True
                x_grid_label: True
                xlog: False
                ylog: False
                x_grid: True
                y_grid: True
                xmin: 0

        FloatLayout:
            size_hint: 1, .1
            Button:
                id: prev
                text: "Prev"
                size_hint: .5, .5
                pos_hint: {"top": 1}
                on_press: root.prev_trip()

            Button:
                id: next
                text: "Next"
                size_hint: .5, .5
                pos_hint: {"x": .5, "top": 1}
                on_press: root.next_trip()

            Button:
                id: home
                text: "Home"
                size_hint: .5, .5
                on_press: root.go_home()
            Button:
                id: remove
                text: "Remove"
                size_hint: .5, .5
                pos_hint: {"x": .5}
                on_release: Factory.TripDeletePopup().open()

                
